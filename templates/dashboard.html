{% include 'head.html' %}

{% include 'header.html' %}

  <div class="container" id="main">
    <div class="page-header">
      <h2>Welcome, {{ user.name }}</h2>
      <p>
        {% if user.role <= 2 %}
        Below you will find tools needed to administrate election comissioners{{user.role == 1 ? ', ' : ' and'}} active elections{{user.role == 1 ? ', and the system as a whole'}}.
        <span class="pull-right">
          <label class="checkbox-inline">
            <input type="checkbox" data-toggle="toggle" data-size="small" name="adminView"> Admin View
          </label>
        </span>
        {% endif %}
      </p>
    </div>
    <div id="studentPanel">
      <div>
        <h4>My Votes</h4>
        <div class="col-sm-8">
          <div class="table-responsive">
            <table class="table">
              <caption>
                These are all registered votes you've cast in the system. Once cast, your vote cannot be changed.
              </caption>
              <thead>
                <tr>
                  <th>Election</th>
                  <th>Time</th>
                  <th>Race</th>
                  <th>Candidate</th>
                </tr>
              </thead>
              <tbody>
                {% for v in myvotes %}
                  <tr>
                    <td>
                      <a href="{{ urlFor('election', {id: v.elecID}) }}">{{v.elecID}}</a>
                    </td>
                    <td>{{v.time|date('M jS, Y \\a\\t g:ia')}}</td>
                    <td>{{v.raceID}}</td>
                    <td>{{v.candidate == -1 ? v.data.writein : v.candidate}}</td>
                  </tr>
                {% else %}
                  <tr>
                    <td colspan="4" class="text-center">
                      You haven't cast any votes yet. :( What're you waiting for, <a href="{{ urlFor('campaigns') }}">make a difference!</a>
                    </td>
                  </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    {% if user.role <= 2 %}
    <div id="adminPanel" class="hidden">
      <div>
        <h4>Manage Elections</h4>
        <div class="col-sm-7">
          <div class="table-responsive">
            <table class="table">
              <caption>
                These are all elections currently in the system. From here, you can do stuff to said elections.
              </caption>
              <thead>
                <tr>
                  <th></th>
                  <th>ID</th>
                  <th>Name</th>
                  <th>Description</th>
                  <th>Commissioner</th>
                </tr>
              </thead>
              <tbody>
                {% for e in elections %}
                <tr class="{{e.approved ? 'success' : 'danger'}}">
                  <th scope="row">
                    <span class="btn btn-xs btn-{{e.approved ? 'danger' : 'success'}}" data-{{e.approved ? 'remove' : 'approve'}}="{{e.id}}">
                      <i class="glyphicon glyphicon-{{e.approved ? 'remove' : 'ok'}}"></i>
                    </span>
                  </th>
                  <td>{{e.id}}</td>
                  <td><a href="{{ urlFor('election', {id: e.id}) }}">{{e.name}}</a></td>
                  <td>{{e.description}}</td>
                  <td>{{e.ec.id}}</td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
        <div class="col-sm-offset-1 col-sm-4 well">
          <p class="text-center">Use this to approve/remove individual election commissioners.</p>
            <div class="form-group">
              <label for="ecUserId" class="col-sm-4 control-label">User ID</label>
              <div class="col-sm-8">
                <input type="number" class="form-control" placeholder="Student ID" id="ecUserId">
              </div>
            </div>
            <div class="form-group">
              <div class="col-sm-offset-4 col-sm-8">
                <button class="btn btn-primary" id="ecApprove">Approve</button>
                <button class="btn btn-danger" id="ecRemove">Remove</button>
              </div>
            </div>
        </div>
      </div>
      <div class="clearfix"></div>
      <div>
        <h4>Manage Users</h4>
        <div class="col-sm-6">
          <div class="table-responsive">
            <table class="table">
              <caption>
                These are all users who have used the system. From here you can do things to said users.
              </caption>
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Name</th>
                  <th>Role</th>
                  <th>Data</th>
                </tr>
              </thead>
              <tbody>
                {% for u in users %}
                <tr>
                  <td scope="row">{{u.id}}</td>
                  <td>{{u.name}}</td>
                  <td>
                  {% if u.role == 1 %}
                    <span class="label label-danger">SuperAdmin</span>
                  {% elseif u.role == 2 %}
                    <span class="label label-primary">Admin</span>
                  {% else %}
                    <span class="label label-default">Student</span>
                  {% endif %}
                  </td>
                  <td>{{u.data|json_encode()}}</td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    {% endif %}
  </div>

{% include 'footer.html' %}
